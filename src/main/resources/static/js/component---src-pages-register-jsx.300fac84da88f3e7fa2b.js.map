{"version":3,"sources":["webpack://books/./node_modules/react-bootstrap/esm/Container.js","webpack://books/./node_modules/react-bootstrap/esm/Row.js","webpack://books/./src/pages/register.jsx"],"names":["Container","_ref","ref","bsPrefix","fluid","_ref$as","as","Component","className","props","prefix","suffix","displayName","defaultProps","DEVICE_SIZES","Row","noGutters","decoratedBsPrefix","sizePrefix","classes","forEach","brkPoint","cols","propValue","infix","push","concat","state","useSelector","companies","dispatch","useDispatch","auth","useAuth","useForm","errors","formState","register","handleSubmit","setError","useEffect","console","log","error","createCompany","company","upsert","result","unwrapResult","login","navigate","routes","response","data","property","message","isAuthenticated","lg","onSubmit","required","minLength","type","placeholder","disabled","isLoading","name","password","block","variant","to"],"mappings":"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","file":"component---src-pages-register-jsx.300fac84da88f3e7fa2b.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport classNames from 'classnames';\nimport React from 'react';\nimport { useBootstrapPrefix } from './ThemeProvider';\nvar defaultProps = {\n  fluid: false\n};\nvar Container = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var bsPrefix = _ref.bsPrefix,\n      fluid = _ref.fluid,\n      _ref$as = _ref.as,\n      Component = _ref$as === void 0 ? 'div' : _ref$as,\n      className = _ref.className,\n      props = _objectWithoutPropertiesLoose(_ref, [\"bsPrefix\", \"fluid\", \"as\", \"className\"]);\n\n  var prefix = useBootstrapPrefix(bsPrefix, 'container');\n  var suffix = typeof fluid === 'string' ? \"-\" + fluid : '-fluid';\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    ref: ref\n  }, props, {\n    className: classNames(className, fluid ? \"\" + prefix + suffix : prefix)\n  }));\n});\nContainer.displayName = 'Container';\nContainer.defaultProps = defaultProps;\nexport default Container;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport classNames from 'classnames';\nimport React from 'react';\nimport { useBootstrapPrefix } from './ThemeProvider';\nvar DEVICE_SIZES = ['xl', 'lg', 'md', 'sm', 'xs'];\nvar defaultProps = {\n  noGutters: false\n};\nvar Row = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var bsPrefix = _ref.bsPrefix,\n      className = _ref.className,\n      noGutters = _ref.noGutters,\n      _ref$as = _ref.as,\n      Component = _ref$as === void 0 ? 'div' : _ref$as,\n      props = _objectWithoutPropertiesLoose(_ref, [\"bsPrefix\", \"className\", \"noGutters\", \"as\"]);\n\n  var decoratedBsPrefix = useBootstrapPrefix(bsPrefix, 'row');\n  var sizePrefix = decoratedBsPrefix + \"-cols\";\n  var classes = [];\n  DEVICE_SIZES.forEach(function (brkPoint) {\n    var propValue = props[brkPoint];\n    delete props[brkPoint];\n    var cols;\n\n    if (propValue != null && typeof propValue === 'object') {\n      cols = propValue.cols;\n    } else {\n      cols = propValue;\n    }\n\n    var infix = brkPoint !== 'xs' ? \"-\" + brkPoint : '';\n    if (cols != null) classes.push(\"\" + sizePrefix + infix + \"-\" + cols);\n  });\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    ref: ref\n  }, props, {\n    className: classNames.apply(void 0, [className, decoratedBsPrefix, noGutters && 'no-gutters'].concat(classes))\n  }));\n});\nRow.displayName = 'Row';\nRow.defaultProps = defaultProps;\nexport default Row;","import { Link, navigate } from \"gatsby\";\nimport React, { useEffect } from \"react\";\nimport { Button, Card, Col, Container, Form, Row } from \"react-bootstrap\";\nimport { useForm } from \"react-hook-form\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport useAuth from \"../components/auth/useAuth\";\nimport { upsert } from \"../components/companies/actions\";\nimport routes from \"../settings/routes\";\nimport { unwrapResult } from \"@reduxjs/toolkit\";\n\nconst Register = () => {\n  const state = useSelector((state) => state.companies);\n  const dispatch = useDispatch();\n  const auth = useAuth();\n  const {\n    formState: { errors },\n    register,\n    handleSubmit,\n    setError,\n  } = useForm();\n\n  useEffect(() => {\n    console.log(state.error);\n  }, [state.error]);\n\n  /**\n   * Creates a new company and attempts to login. On success redirects to the homepage.\n   *\n   * @param {*} e - The form submission event.\n   */\n  const createCompany = async (company) => {\n    try {\n      const result = await dispatch(upsert(company));\n      unwrapResult(result);\n\n      const login = await auth.login(company);\n      unwrapResult(login);\n\n      navigate(routes.home);\n    } catch (error) {\n      console.log(error);\n      const errors = error.response?.data?.errors;\n\n      if (errors) {\n        errors.forEach(({ property, message }) =>\n          setError(property, { message })\n        );\n      } else {\n        console.error(error, error.response);\n      }\n    }\n  };\n\n  /**\n   * If the user is already logged in redirects to the homepage.\n   */\n  if (auth.isAuthenticated) {\n    navigate(routes.home);\n    return null;\n  }\n\n  /**\n   * UI\n   */\n  return (\n    <Container>\n      <Row className=\"justify-content-center\">\n        <Col lg=\"5\">\n          <div className=\"text-center\">\n            <h5 className=\"mb-0\">Benvenuto in</h5>\n            <h1 className=\"display-3 font-weight-bold mb-4\">Books</h1>\n            <h4 className=\"mb-2\">Registra un'azienda</h4>\n          </div>\n\n          <Card className=\"mb-3\">\n            <Card.Body>\n              <Form\n                className=\"text-left\"\n                onSubmit={handleSubmit(createCompany)}\n              >\n                <Form.Group>\n                  <Form.Label>Ragione Sociale</Form.Label>\n                  <Form.Control\n                    {...register(\"name\", { required: true, minLength: 3 })}\n                    type=\"text\"\n                    placeholder=\"Azienda SRC\"\n                    disabled={state.isLoading}\n                    className={errors.name && \"is-invalid\"}\n                  />\n                  <Form.Control.Feedback type=\"invalid\">\n                    {errors.name && errors.name.message}\n                  </Form.Control.Feedback>\n                </Form.Group>\n                <Form.Group>\n                  <Form.Label>Password</Form.Label>\n                  <Form.Control\n                    {...register(\"password\")}\n                    type=\"password\"\n                    placeholder=\"password\"\n                    disabled={state.isLoading}\n                    className={errors.password && \"is-invalid\"}\n                  />\n                  <Form.Control.Feedback type=\"invalid\">\n                    {errors.password && errors.password.message}\n                  </Form.Control.Feedback>\n                </Form.Group>\n                <Button\n                  block\n                  type=\"submit\"\n                  className=\"my-4\"\n                  variant=\"primary\"\n                  disabled={state.isLoading}\n                >\n                  Registra\n                </Button>\n              </Form>\n            </Card.Body>\n          </Card>\n          <p className=\"text-center\">\n            Se sei già registrato <Link to={routes.login}>accedi qui</Link>.\n          </p>\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n\nexport default Register;\n"],"sourceRoot":""}